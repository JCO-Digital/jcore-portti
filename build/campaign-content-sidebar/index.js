(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.i18n,o=window.wp.plugins,r=window.wp.editor,i=window.wp.data,a=window.wp.coreData,l=window.wp.element,n=window.wp.components,s=window.wp.apiFetch;var p=e.n(s);const c=window.wp.url,_=window.ReactJSXRuntime;(0,o.registerPlugin)("jcore-portti-sidebar",{render:()=>{const e=(0,i.useSelect)(e=>e("core/editor").getCurrentPostType()),[o={},s]=(0,a.useEntityProp)("postType",e,"meta"),d=o._jcore_portti_selected_post||0,{searchResults:j,isLoading:h,searchPosts:u,selectedPost:g}=(e=>{const[o,r]=(0,l.useState)([]),[i,a]=(0,l.useState)(!1),[n,s]=(0,l.useState)(null);return(0,l.useEffect)(()=>{e?(async()=>{try{const o=await p()({path:(0,c.addQueryArgs)(`/wp/v2/pages/${e}`,{_fields:"id,title"})});s({value:o.id,label:o.title.rendered||(0,t.__)("(No title)","jcore-portti")})}catch{try{const o=await p()({path:(0,c.addQueryArgs)(`/wp/v2/posts/${e}`,{_fields:"id,title"})});s({value:o.id,label:o.title.rendered||(0,t.__)("(No title)","jcore-portti")})}catch{s(null)}}})():s(null)},[e]),{searchResults:o,isLoading:i,searchPosts:async e=>{if(!e||e.length<2)r([]);else{a(!0);try{const[o,i]=await Promise.all([p()({path:(0,c.addQueryArgs)("/wp/v2/pages",{search:e,per_page:10,_fields:"id,title,type"})}),p()({path:(0,c.addQueryArgs)("/wp/v2/posts",{search:e,per_page:10,_fields:"id,title,type"})})]),a=[...o.map(e=>({value:e.id,label:`${e.title.rendered||(0,t.__)("(No title)","jcore-portti")} (${(0,t.__)("Page","jcore-portti")})`})),...i.map(e=>({value:e.id,label:`${e.title.rendered||(0,t.__)("(No title)","jcore-portti")} (${(0,t.__)("Post","jcore-portti")})`}))];r(a)}catch(e){console.error("Error searching posts:",e),r([])}finally{a(!1)}}},selectedPost:n}})(d),w=(e,t)=>{s({...o||{},[e]:t})};if("jcore-portal-content"!==e||!o)return null;const m=d>0;return(0,_.jsx)(r.PluginDocumentSettingPanel,{name:"jcore-portti-settings",title:(0,t.__)("Campaign Settings","jcore-portti"),children:(0,_.jsxs)("div",{className:"jcore-portti-meta-fields",children:[(0,_.jsx)(n.PanelRow,{children:(0,_.jsxs)("div",{style:{marginBottom:"20px",width:"100%"},children:[(0,_.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,t.__)("Start Date","jcore-portti")}),(0,_.jsx)(n.ToggleControl,{label:(0,t.__)("Set Start Date","jcore-portti"),checked:!!o._jcore_portti_start_date,onChange:e=>w("_jcore_portti_start_date",e?(new Date).toISOString():"")}),o._jcore_portti_start_date?(0,_.jsx)(n.DateTimePicker,{currentDate:o._jcore_portti_start_date,onChange:e=>w("_jcore_portti_start_date",e),is12Hour:!1}):null]})}),(0,_.jsx)(n.PanelRow,{children:(0,_.jsxs)("div",{style:{marginBottom:"20px",width:"100%"},children:[(0,_.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:(0,t.__)("End Date","jcore-portti")}),(0,_.jsx)(n.ToggleControl,{label:(0,t.__)("Set End Date","jcore-portti"),checked:!!o._jcore_portti_end_date,onChange:e=>w("_jcore_portti_end_date",e?(new Date).toISOString():"")}),o._jcore_portti_end_date?(0,_.jsx)(n.DateTimePicker,{currentDate:o._jcore_portti_end_date,onChange:e=>w("_jcore_portti_end_date",e),is12Hour:!1}):null]})}),(0,_.jsx)(n.PanelRow,{children:(0,_.jsx)("div",{style:{marginBottom:"20px",width:"100%"},children:(0,_.jsxs)("div",{style:{position:"relative"},children:[(0,_.jsx)(n.ComboboxControl,{label:(0,t.__)("Selected Page/Post","jcore-portti"),value:d||null,options:g&&!j.length?[g]:j,onChange:e=>w("_jcore_portti_selected_post",e||0),onFilterValueChange:e=>u(e),help:(0,t.__)("Search for a specific page or post to show this content on.","jcore-portti")}),h&&(0,_.jsx)("div",{style:{position:"absolute",right:"8px",top:"32px"},children:(0,_.jsx)(n.Spinner,{})})]})})}),!m&&(0,_.jsx)(n.TextControl,{label:(0,t.__)("Route Path","jcore-portti"),value:o._jcore_portti_route_path,onChange:e=>w("_jcore_portti_route_path",e),help:(0,t.__)("Example: /products/* or /shop. Leave empty for all pages.","jcore-portti")}),(0,_.jsx)(n.SelectControl,{label:(0,t.__)("Priority","jcore-portti"),value:o._jcore_portti_priority,options:[{label:(0,t.__)("High","jcore-portti"),value:"high"},{label:(0,t.__)("Medium","jcore-portti"),value:"medium"},{label:(0,t.__)("Low","jcore-portti"),value:"low"}],onChange:e=>w("_jcore_portti_priority",e)})]})})}})})();